"use strict";(self["webpackChunkgearing"]=self["webpackChunkgearing"]||[]).push([[427],{8427:function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var a=s(3396);const o=(0,a._)("h1",null,"Seus dados:",-1);function r(e,t,s,r,n,l){const i=(0,a.up)("DataChangeForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[o,(0,a._)("div",null,[(0,a.Wm)(i)])],64)}s(7658);var n=s(9242),l=s(7139);const i=e=>((0,a.dD)("data-v-7ff749c8"),e=e(),(0,a.Cn)(),e),u={key:0},d={key:0},p=i((()=>(0,a._)("label",null,"Digite sua senha para visualizar seus dados:",-1))),m=i((()=>(0,a._)("button",{type:"submit"},"Enviar",-1))),c={key:1},w=i((()=>(0,a._)("label",null," Email: ",-1))),h=i((()=>(0,a._)("label",null," Nome de usuário: ",-1))),f=i((()=>(0,a._)("label",null," Nova senha: ",-1))),D=i((()=>(0,a._)("label",null," Confirme sua nova senha: ",-1))),U=i((()=>(0,a._)("button",{type:"submit"},"Alterar dados",-1)));function g(e,t,s,o,r,i){const g=(0,a.up)("AlertPassword");return(0,a.wg)(),(0,a.iD)(a.HY,null,[r.checkingPassword?((0,a.wg)(),(0,a.iD)("section",u,[r.showAlert?((0,a.wg)(),(0,a.iD)("label",d,[(0,a.Wm)(g,{onClose:t[0]||(t[0]=e=>i.closeAlert())})])):(0,a.kq)("",!0),(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)((e=>i.check()),["prevent"]))},[p,(0,a.wy)((0,a._)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.user.password=e),placeholder:"Digite sua senha"},null,512),[[n.nr,r.user.password]]),m],32)])):(0,a.kq)("",!0),r.checkingPassword?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("section",c,[(0,a._)("form",{class:"form",onSubmit:t[7]||(t[7]=(0,n.iM)((e=>i.updateData()),["prevent"]))},[w,(0,a.wy)((0,a._)("input",{type:"email","onUpdate:modelValue":t[3]||(t[3]=e=>r.newUserData.email=e),placeholder:"Digite seu email"},null,512),[[n.nr,r.newUserData.email]]),h,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>r.newUserData.username=e),placeholder:"Digite seu novo nome de usuário"},null,512),[[n.nr,r.newUserData.username]]),f,(0,a.wy)((0,a._)("input",{class:(0,l.C_)({"form-password":r.differentPasswords}),type:"password","onUpdate:modelValue":t[5]||(t[5]=e=>r.newUserData.password=e),placeholder:"Nova senha",minlength:"6"},null,2),[[n.nr,r.newUserData.password]]),D,(0,a.wy)((0,a._)("input",{class:(0,l.C_)({"form-password":r.differentPasswords}),type:"password","onUpdate:modelValue":t[6]||(t[6]=e=>r.newUserData.confirmePassword=e),placeholder:"Confirme sua nova senha"},null,2),[[n.nr,r.newUserData.confirmePassword]]),U],32),(0,a._)("button",{onClick:t[8]||(t[8]=e=>i.deleteUser())},"Deletar conta")]))],64)}var v=s(4161);function C(e,t,s,o,r,n){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Uk)(" Senha incorreta tente novamente "),(0,a._)("button",{onClick:t[0]||(t[0]=e=>n.closeAlert())}," X ")])}var _={methods:{closeAlert(){this.$emit("close")}}},b=s(89);const k=(0,b.Z)(_,[["render",C],["__scopeId","data-v-65a3cd71"]]);var P=k,$=s(2492),y=s.n($),A={components:{AlertPassword:P},data(){return{user:{password:""},newUserData:{email:"",username:this.$store.state.user.username,password:"",confirmePassword:""},checkingPassword:!0,showAlert:!1,differentPasswords:!1}},methods:{check(){v.Z.post(`${this.$store.state.req.api}/user/userData.php`,{email:this.$store.state.user.email,password:this.user.password}).then((e=>{e.data.success?this.checkingPassword=!1:(this.showAlert=!0,console.log(e.data.error))}))},closeAlert(){this.showAlert=!1},updateData(){this.newUserData.password==this.newUserData.confirmePassword&&y().fire({title:"Dados prontos para serem alterados",text:"Seus dados serão alterados, mas não se preocupe, a qualquer momento você poderá altera-los novamente!",showCancelButton:!0,confirmButtonText:"Tenho certeza",cancelButtonText:"Não tenho certeza",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}}).then((e=>{e.isConfirmed&&(this.newUserData.password||(this.newUserData.password=this.user.password),this.newUserData.email||(this.newUserData.email=this.$store.state.user.email),v.Z.post(`${this.$store.state.req.api}/user/updateUserData.php`,{email:this.newUserData.email,name:this.newUserData.username,password:this.newUserData.password,id:localStorage.getItem("idSession")}).then((e=>{"true"==e.data.result?this.$router.push("/"):(y().fire({title:"Erro",text:"Não foi possível alterar seus dados",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}}),v.Z.post(`${this.$store.state.req.api}/log/registerErro.php`,{erro:e.data.problem})),this.newUserData.password="",this.newUserData.confirmePassword=""})))}))},deleteUser(){y().fire({title:"Tem certeza?",text:"Essa ação apagará todos os seus dados permanentemente",showCancelButton:!0,confirmButtonText:"Tenho certeza",cancelButtonText:"Não tenho certeza",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}}).then((e=>{e.isConfirmed&&v.Z.post(`${this.$store.state.req.api}/user/deleteUser.php`,{id:localStorage.getItem("idSession")}).then((e=>{"deleted user"==e.data.result?(y().fire({title:"Usuário deletado",text:"Seu usuário foi deletado com sucesso",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}}),this.$router.push("/"),localStorage.removeItem("idSession")):"user not deleted"==e.data.result&&(y().fire({title:"Usuário não deletado",text:"Por alguma razão inesperada não foi possível deletar seu usuário",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}}),v.Z.post(`${this.$store.state.req.api}/log/registerErro.php`,{erro:e.data.problem}))}))}))}},watch:{newUserData:{handler(){this.newUserData.confirmePassword&&this.newUserData.password!=this.newUserData.confirmePassword?this.differentPasswords=!0:this.differentPasswords=!1},deep:!0}},mounted(){y().fire({title:"Aviso:",text:"Dados que não forem alterados permaneceram com o mesmo valor",customClass:{popup:"swal-popup-custom",title:"swal-title-custom",htmlContainer:"swal-html-container-custom"}})}};const S=(0,b.Z)(A,[["render",g],["__scopeId","data-v-7ff749c8"]]);var q=S,x={data(){return{}},components:{DataChangeForm:q},beforeCreate(){this.$store.state.user.auth||this.$router.push("/")}};const Z=(0,b.Z)(x,[["render",r]]);var z=Z}}]);
//# sourceMappingURL=427.06739e28.js.map